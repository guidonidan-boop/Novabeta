<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova (beta) - Analisi di Sostenibilità Digitale</title>
    <meta name="description" content="Un assistente AI per calcolare l'impatto ambientale, l'accessibilità e la sostenibilità economica dei contenuti digitali.">

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons via CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <style>
        /* Stili custom per animazioni, componenti e tema scuro */
        @keyframes spin {
            to { transform: rotate(360deg ); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        .drag-active {
            border-color: #96E6B3 !important;
            background-color: #2a4a3a !important;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Stili per la stampa */
        @media print {
            body { background: white !important; color: black !important; }
            .no-print { display: none !important; }
            .print-bg-white { background-color: white !important; }
            .print-text-black { color: black !important; }
        }
        /* Stili per la scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1F3B2C;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #96E6B3;
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen bg-[#1F3B2C] text-[#FFFFFF]">
    <div id="app"></div>

    <script>
        class NovaSustainabilityAnalyzer {
            constructor() {
                this.uploadedFile = null;
                this.analysisResults = null;
                this.isAnalyzing = false;
                this.dragActive = false;
                this.error = null;
                this.activeModal = null;

                this.init();
            }

            init() {
                this.render();
                this.attachEventListeners();
                this.initializeLucideIcons();
            }

            initializeLucideIcons() {
                if (window.lucide) {
                    lucide.createIcons();
                }
            }

            attachEventListeners() {
                const fileInput = document.getElementById('file-upload');
                const uploadArea = document.getElementById('upload-area');
                const analyzeBtn = document.getElementById('analyze-btn');
                const removeBtn = document.getElementById('remove-btn');

                if (fileInput) fileInput.addEventListener('change', (e) => this.handleFileInput(e));
                if (uploadArea) {
                    uploadArea.addEventListener('dragenter', (e) => this.handleDrag(e));
                    uploadArea.addEventListener('dragover', (e) => this.handleDrag(e));
                    uploadArea.addEventListener('dragleave', (e) => this.handleDrag(e));
                    uploadArea.addEventListener('drop', (e) => this.handleDrop(e));
                }
                if (analyzeBtn) analyzeBtn.addEventListener('click', () => this.analyzeFile());
                if (removeBtn) removeBtn.addEventListener('click', () => this.removeFile());

                // Listener per i popup (modali)
                document.body.addEventListener('click', (e) => {
                    const infoButton = e.target.closest('.info-btn');
                    if (infoButton) {
                        const modalId = infoButton.dataset.modal;
                        this.showModal(modalId);
                    }
                    if (e.target.classList.contains('modal-close') || e.target.id === 'modal-backdrop') {
                        this.hideModal();
                    }
                });
            }

            handleDrag(e) {
                e.preventDefault();
                e.stopPropagation();
                const uploadArea = document.getElementById('upload-area');
                if (e.type === "dragenter" || e.type === "dragover") {
                    this.dragActive = true;
                    uploadArea?.classList.add('drag-active');
                } else if (e.type === "dragleave") {
                    this.dragActive = false;
                    uploadArea?.classList.remove('drag-active');
                }
            }

            handleDrop(e) {
                e.preventDefault();
                e.stopPropagation();
                document.getElementById('upload-area')?.classList.remove('drag-active');
                this.dragActive = false;
                if (e.dataTransfer.files && e.dataTransfer.files[0]) {
                    this.handleFile(e.dataTransfer.files[0]);
                }
            }

            handleFileInput(e) {
                if (e.target.files && e.target.files[0]) {
                    this.handleFile(e.target.files[0]);
                }
            }

            handleFile(file) {
                this.error = null;
                const validTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/svg+xml', 'application/pdf'];
                if (!validTypes.includes(file.type)) {
                    this.error = 'Formato file non supportato. Usa JPG, PNG, WebP, SVG o PDF.';
                    this.render();
                    return;
                }
                if (file.size > 15 * 1024 * 1024) { // Max 15MB
                    this.error = 'File troppo grande. Dimensione massima: 15MB.';
                    this.render();
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    this.uploadedFile = {
                        file: file,
                        url: e.target.result,
                        name: file.name,
                        size: file.size,
                        type: file.type
                    };
                    this.analysisResults = null;
                    this.render();
                };
                reader.onerror = () => {
                    this.error = 'Errore durante la lettura del file.';
                    this.render();
                };
                reader.readAsDataURL(file);
            }

            removeFile() {
                this.uploadedFile = null;
                this.analysisResults = null;
                this.error = null;
                this.render();
            }

            // --- Funzioni di Analisi ---

            calculateEnvironmentalImpact(file) {
                const sizeInMB = file.size / (1024 * 1024);
                
                // 1. CO₂ per upload
                const co2UploadG = sizeInMB * 0.072;

                // 2. Acqua per upload (usiamo una media di 100 ml/MB per il calcolo)
                const h2oUploadMl = sizeInMB * 100;

                // 3. CO₂ per visualizzazione base (ipotizziamo 1 minuto di visualizzazione)
                const minutes = 1; // Stima base, potrebbe essere affinata
                const co2ViewG = minutes * 6;

                // 4. Aggiustamento per colori (semplificato, da integrare con analisi immagine)
                // Per ora usiamo un fattore neutro
                const color_factor = 0.25; // Valore medio
                const co2ViewColorG = co2ViewG * (1 + color_factor);

                return {
                    co2UploadG: parseFloat(co2UploadG.toFixed(3)),
                    h2oUploadMl: parseFloat(h2oUploadMl.toFixed(2)),
                    co2ViewColorG: parseFloat(co2ViewColorG.toFixed(2)),
                };
            }

            analyzeAccessibility() {
                // Simulazione analisi accessibilità
                const contrastRatio = 4.8; // Valore simulato
                const hasAltText = true; // Valore simulato
                const hasTextInImage = false; // Valore simulato
                const isFontReadable = true; // Valore simulato

                let score = 0;
                if (contrastRatio >= 4.5) score += 40;
                else if (contrastRatio >= 3) score += 20;
                if (hasAltText) score += 30;
                if (!hasTextInImage) score += 20;
                if (isFontReadable) score += 10;

                let status = '❌';
                if (score >= 85) status = '✅';
                else if (score >= 60) status = '⚠️';

                return {
                    score: Math.min(100, score),
                    status,
                    contrastRatio: contrastRatio.toFixed(2),
                    hasAltText,
                    hasTextInImage,
                    isFontReadable
                };
            }

            analyzeEconomicSustainability() {
                // Simulazione analisi economica
                const usesDesignSystem = true;
                const usesOpenSourceFonts = true;
                const hasSimpleLayout = false;

                let score = 0;
                if (usesDesignSystem) score += 40;
                if (usesOpenSourceFonts) score += 40;
                if (hasSimpleLayout) score += 20;

                let status = '❌';
                if (score >= 80) status = '✅';
                else if (score >= 50) status = '⚠️';

                return {
                    score,
                    status,
                    usesDesignSystem,
                    usesOpenSourceFonts,
                    hasSimpleLayout
                };
            }

            async analyzeFile() {
                if (!this.uploadedFile) {
                    this.error = 'Nessun file caricato.';
                    this.render();
                    return;
                }
                this.isAnalyzing = true;
                this.error = null;
                this.render();

                // Simula un'attesa per l'analisi
                await new Promise(resolve => setTimeout(resolve, 1500));

                try {
                    const environmental = this.calculateEnvironmentalImpact(this.uploadedFile);
                    const accessibility = this.analyzeAccessibility();
                    const economic = this.analyzeEconomicSustainability();

                    this.analysisResults = {
                        environmental,
                        accessibility,
                        economic,
                        timestamp: new Date().toISOString()
                    };
                } catch (error) {
                    console.error('Errore durante l\'analisi:', error);
                    this.error = 'Errore durante l\'analisi: ' + error.message;
                }

                this.isAnalyzing = false;
                this.render();
            }

            // --- Funzioni di Rendering ---

            render() {
                const app = document.getElementById('app');
                if (!app) return;

                app.innerHTML = `
                    <div class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8">
                        <header class="text-center mb-8 no-print">
                            <h1 class="text-4xl sm:text-5xl font-bold text-[#96E6B3]">Nova <span class="text-2xl font-light text-white/80">(beta)</span></h1>
                            <p class="text-white/80 mt-2 max-w-2xl mx-auto">Analizza l'impatto dei tuoi contenuti digitali. Carica un file per scoprire la sua impronta ambientale, accessibilità e sostenibilità economica.</p>
                        </header>

                        <main class="w-full max-w-4xl mx-auto">
                            ${this.isAnalyzing ? this.renderLoader() : ''}
                            ${!this.isAnalyzing && !this.uploadedFile ? this.renderUploadArea() : ''}
                            ${!this.isAnalyzing && this.uploadedFile ? this.renderFilePreview() : ''}
                            ${this.error ? this.renderError() : ''}
                            ${this.analysisResults ? this.renderResults() : ''}
                        </main>
                        
                        <footer class="text-center mt-12 text-white/60 text-sm no-print">
                            <p>&copy; ${new Date().getFullYear()} Nova. Sviluppato per un futuro digitale più sostenibile.</p>
                        </footer>
                    </div>
                    ${this.renderModals()}
                `;
                this.initializeLucideIcons();
                this.attachEventListeners();
            }

            renderLoader() {
                return `
                    <div class="text-center p-8 fade-in">
                        <div class="w-12 h-12 border-4 border-[#96E6B3] border-t-transparent rounded-full animate-spin mx-auto"></div>
                        <p class="mt-4 text-lg text-white/90">Analisi in corso...</p>
                    </div>
                `;
            }

            renderUploadArea() {
                return `
                    <div id="upload-area" class="relative border-2 border-dashed border-white/40 rounded-2xl p-8 sm:p-12 text-center cursor-pointer transition-all duration-300 hover:border-[#96E6B3] hover:bg-white/5">
                        <input type="file" id="file-upload" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                        <div class="flex flex-col items-center justify-center space-y-4">
                            <i data-lucide="upload-cloud" class="w-16 h-16 text-[#96E6B3]"></i>
                            <p class="text-lg font-semibold text-white">Trascina un file qui o clicca per caricare</p>
                            <p class="text-sm text-white/70">Supporta Immagini (JPG, PNG, WebP, SVG) e PDF. Max 15MB.</p>
                        </div>
                    </div>
                `;
            }

            renderFilePreview() {
                const isImage = this.uploadedFile.type.startsWith('image/');
                return `
                    <div class="bg-[#2a4a3a]/50 border border-white/20 rounded-2xl p-6 fade-in no-print">
                        <div class="flex flex-col sm:flex-row items-center gap-6">
                            ${isImage ? 
                                `<img src="${this.uploadedFile.url}" alt="Anteprima" class="w-24 h-24 object-cover rounded-lg border-2 border-white/30">` :
                                `<div class="w-24 h-24 flex items-center justify-center bg-white/10 rounded-lg border-2 border-white/30">
                                    <i data-lucide="file-text" class="w-12 h-12 text-[#96E6B3]"></i>
                                 </div>`
                            }
                            <div class="flex-grow text-center sm:text-left">
                                <p class="font-bold text-lg text-white truncate">${this.uploadedFile.name}</p>
                                <p class="text-sm text-white/70">${(this.uploadedFile.size / 1024 / 1024).toFixed(2)} MB · ${this.uploadedFile.type}</p>
                            </div>
                            <div class="flex items-center gap-3 mt-4 sm:mt-0">
                                <button id="remove-btn" class="p-2 text-white/80 hover:text-red-400 transition-colors">
                                    <i data-lucide="trash-2" class="w-6 h-6"></i>
                                </button>
                                <button id="analyze-btn" class="bg-[#96E6B3] text-[#1F3B2C] font-bold py-2 px-6 rounded-full hover:bg-white transition-colors">
                                    Analizza
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderError() {
                return `
                    <div class="bg-red-900/50 border border-red-500 text-red-300 p-4 rounded-lg mt-4 flex items-center gap-3 fade-in">
                        <i data-lucide="alert-triangle" class="w-5 h-5"></i>
                        <span>${this.error}</span>
                    </div>
                `;
            }

            renderResults() {
                const { environmental, accessibility, economic } = this.analysisResults;
                return `
                    <div class="mt-8 space-y-6 fade-in">
                        <!-- Impatto Ambientale -->
                        <div class="bg-[#2a4a3a]/50 border border-white/20 rounded-2xl p-6">
                            <h3 class="text-2xl font-bold text-[#96E6B3] mb-4">🌱 Impatto Ambientale</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                                ${this.renderMetric('CO₂ per Upload', `${environmental.co2UploadG} g`, 'co2-upload')}
                                ${this.renderMetric('Acqua per Upload', `${environmental.h2oUploadMl} ml`, 'h2o-upload')}
                                ${this.renderMetric('CO₂ per Visualizzazione', `${environmental.co2ViewColorG} g`, 'co2-view')}
                            </div>
                        </div>

                        <!-- Accessibilità -->
                        <div class="bg-[#2a4a3a]/50 border border-white/20 rounded-2xl p-6">
                            <h3 class="text-2xl font-bold text-[#96E6B3] mb-4">👁️ Accessibilità (WCAG 2.1)</h3>
                            <div class="flex items-center justify-center mb-4">
                                <span class="text-3xl font-bold mr-3">${accessibility.status}</span>
                                <span class="text-white/80">Punteggio: ${accessibility.score}/100</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                                ${this.renderMetric('Contrasto Colore', `${accessibility.contrastRatio}:1`, 'contrast')}
                                ${this.renderMetric('Testo Alternativo', accessibility.hasAltText ? '✅' : '❌', 'alt-text')}
                                ${this.renderMetric('Testo in Immagini', !accessibility.hasTextInImage ? '✅' : '❌', 'text-in-image')}
                                ${this.renderMetric('Leggibilità Font', accessibility.isFontReadable ? '✅' : '❌', 'font-readability')}
                            </div>
                        </div>

                        <!-- Sostenibilità Economica -->
                        <div class="bg-[#2a4a3a]/50 border border-white/20 rounded-2xl p-6">
                            <h3 class="text-2xl font-bold text-[#96E6B3] mb-4">💰 Sostenibilità Economica</h3>
                             <div class="flex items-center justify-center mb-4">
                                <span class="text-3xl font-bold mr-3">${economic.status}</span>
                                <span class="text-white/80">Punteggio: ${economic.score}/100</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                                ${this.renderMetric('Uso Design System', economic.usesDesignSystem ? '✅' : '⚠️', 'design-system')}
                                ${this.renderMetric('Font Open Source', economic.usesOpenSourceFonts ? '✅' : '❌', 'open-fonts')}
                                ${this.renderMetric('Layout Modulare', economic.hasSimpleLayout ? '✅' : '⚠️', 'modular-layout')}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderMetric(label, value, modalId) {
                return `
                    <div class="bg-white/5 p-4 rounded-lg">
                        <div class="flex items-center justify-center gap-2">
                            <p class="text-sm text-white/70">${label}</p>
                            <button class="info-btn text-white/60 hover:text-[#96E6B3]" data-modal="${modalId}">
                                <i data-lucide="info" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <p class="text-2xl font-bold text-white mt-1">${value}</p>
                    </div>
                `;
            }

            renderModals() {
                const modals = {
                    'co2-upload': {
                        title: 'CO₂ per Upload',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> Caricare un contenuto digitale consuma energia nei server, nella rete e nei dispositivi. Questa energia, in media, genera circa 0.072 grammi di CO₂ per ogni megabyte trasferito.</p>
                            <p class="text-white/80"><strong>Fonte:</strong> <a href="https://sustainablewebdesign.org/estimating-digital-emissions/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Sustainable Web Design – Estimating Digital Emissions</a></p>`
                    },
                    'h2o-upload': {
                        title: 'Acqua per Upload',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> I data center usano acqua per raffreddare i server. A seconda della tecnologia e del paese, ogni MB trasferito può usare da 1 a 205 millilitri d’acqua.</p>
                            <p class="text-white/80"><strong>Fonti:</strong></p>
                            <ul class="list-disc list-inside text-white/80 space-y-1 mt-2">
                                <li><a href="https://www.mdpi.com/2071-1050/7/8/11260" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">MDPI</a></li>
                                <li><a href="https://www.researchgate.net/publication/281719759" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">ResearchGate</a></li>
                                <li><a href="https://watercalculator.org/footprint/data-centers-water-use/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">WaterCalculator.org</a></li>
                            </ul>`
                    },
                    'co2-view': {
                        title: 'CO₂ per Visualizzazione',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> Ogni minuto in cui un utente visualizza un contenuto online consuma energia per alimentare lo schermo, la rete e i server. In media, ciò produce 6 grammi di CO₂ per minuto di visualizzazione. L'uso di colori chiari su schermi OLED può aumentare questo consumo.</p>
                            <p class="text-white/80"><strong>Fonti:</strong></p>
                            <ul class="list-disc list-inside text-white/80 space-y-1 mt-2">
                                <li><a href="https://www.iea.org/commentaries/the-carbon-footprint-of-streaming-video" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">IEA</a></li>
                                <li><a href="https://www.cloudzero.com/blog/tech-carbon-footprint/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">CloudZero</a></li>
                                <li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8876531/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">PMC Study on OLED</a></li>
                            </ul>`
                    },
                    'contrast': {
                        title: 'Contrasto Colore (WCAG 1.4.3 )',
                        content: `
                            <p class="text-white/80 mb-4">Il contrasto tra il testo e lo sfondo deve essere sufficientemente elevato per garantire la leggibilità anche a persone con disabilità visive. Le WCAG stabiliscono che il rapporto minimo deve essere <strong>4.5:1</strong> per il testo normale e <strong>3:1</strong> per testi grandi.</p>
                            <p class="text-white/80"><strong>Fonte:</strong> <a href="https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Linea guida WCAG 1.4.3</a></p>`
                    },
                    'alt-text': {
                        title: 'Testo Alternativo (WCAG 1.1.1 )',
                        content: `
                            <p class="text-white/80 mb-4">Ogni immagine dovrebbe includere un testo descrittivo (attributo "alt") che spieghi il contenuto visivo a chi non può vederlo. È fondamentale per utenti non vedenti che usano screen reader.</p>
                            <p class="text-white/80"><strong>Fonte:</strong> <a href="https://www.w3.org/WAI/WCAG21/Understanding/non-text-content/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Linea guida WCAG 1.1.1</a></p>`
                    },
                    'text-in-image': {
                        title: 'Testo in Immagini (WCAG 1.4.5 )',
                        content: `
                            <p class="text-white/80 mb-4">Le WCAG raccomandano di non inserire testo dentro immagini, poiché non è leggibile dagli screen reader, non può essere ingrandito correttamente senza perdita di qualità e non è selezionabile o copiabile dall'utente.</p>
                            <p class="text-white/80"><strong>Fonte:</strong> <a href="https://www.w3.org/WAI/WCAG21/Understanding/images-of-text/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Linea guida WCAG 1.4.5</a></p>`
                    },
                    'font-readability': {
                        title: 'Leggibilità del Testo',
                        content: `
                            <p class="text-white/80 mb-4">Anche se non è un criterio WCAG diretto, l'uso di font chiari, di dimensioni adeguate (≥ 16px per il corpo del testo ) e senza effetti grafici distorsivi migliora l'accessibilità per persone con dislessia o disabilità cognitive.</p>
                            <p class="text-white/80"><strong>Riferimento:</strong> <a href="https://www.w3.org/WAI/WCAG21/quickref/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">WCAG 2.1 Quick Reference</a></p>`
                    },
                    'design-system': {
                        title: 'Elementi da Design System',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> Se il contenuto usa componenti di un design system o libreria visiva standard (es. pulsanti, card, icone ), sarà più veloce ed economico da modificare, sviluppare e replicare. La coerenza riduce i costi di manutenzione e migliora l'usabilità.</p>
                            <p class="text-white/80"><strong>Riferimenti:</strong></p>
                            <ul class="list-disc list-inside text-white/80 space-y-1 mt-2">
                                <li><a href="https://material.io/design" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Material Design</a></li>
                                <li><a href="https://www.ibm.com/design/language/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">IBM Design Language</a></li>
                            </ul>`
                    },
                    'open-fonts': {
                        title: 'Uso di Font Open Source',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> I font open source (come quelli di Google Fonts ) eliminano i costi di licenza, sono compatibili su diverse piattaforme e spesso sono ottimizzati per il web, risultando leggeri da caricare. L'uso di font proprietari può comportare costi elevati e limiti di utilizzo.</p>
                            <p class="text-white/80"><strong>Riferimento:</strong> <a href="https://fonts.google.com/" target="_blank" rel="noopener noreferrer" class="text-[#96E6B3] hover:underline">Google Fonts</a></p>`
                    },
                    'modular-layout': {
                        title: 'Layout Semplice e Riutilizzabile',
                        content: `
                            <p class="text-white/80 mb-4"><strong>Cosa significa:</strong> Un layout semplice e modulare, basato su griglie coerenti e blocchi standard, è più facile da adattare (es. per dispositivi mobili ), mantenere e riusare in altri progetti. Questo riduce i costi operativi di design e sviluppo. L'eccessiva complessità grafica aumenta i costi e i tempi di lavorazione.</p>`
                    }
                };

                return Object.entries(modals).map(([id, { title, content }]) => `
                    <div id="${id}-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50 hidden">
                        <div id="modal-backdrop" class="absolute inset-0"></div>
                        <div class="bg-[#1F3B2C] border border-[#96E6B3] rounded-2xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto relative z-10">
                            <button class="modal-close absolute top-4 right-4 text-white/70 hover:text-white">
                                <i data-lucide="x" class="w-6 h-6"></i>
                            </button>
                            <h4 class="text-2xl font-bold text-[#96E6B3] mb-4">${title}</h4>
                            <div>${content}</div>
                        </div>
                    </div>
                `).join('');
            }

            // --- Gestione Modali ---
            showModal(modalId) {
                this.hideModal(); // Chiudi eventuali modali aperti
                const modal = document.getElementById(`${modalId}-modal`);
                if (modal) {
                    this.activeModal = modal;
                    modal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                    lucide.createIcons();
                }
            }

            hideModal() {
                if (this.activeModal) {
                    this.activeModal.classList.add('hidden');
                    this.activeModal = null;
                    document.body.style.overflow = '';
                }
            }
        }

        // Inizializza l'applicazione
        document.addEventListener('DOMContentLoaded', () => {
            new NovaSustainabilityAnalyzer();
        });
    </script>
</body>
</html>
